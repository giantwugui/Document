Spring Cloud是一套组件，可以细分为多种组件，如服务发现、配置中心、消息总线、负载均衡、断路器和数据监控等。

* **服务治理和服务发现：**主要使用NetFlix Eureka作为服务质量伦理的。Spring Cloud对其进行了一次封装，可以以Spring Boot风格使用它，*通过服务注册将单个微服务节点注册给服务治理中心，这样服务治理中心就可以治理单个微服务节点。服务发现则是微服务节点可以对服务治理中心发送消息，使得服务治理中心可以将新的微服务节点纳入管理。*

* **客户端负载均衡：**微服务的开发中，将一个大系统拆分为多个微服务系统，各个微服务系统之间需要相互协作才能完成业务需求。每个微服务系统可能存在多个节点，当一个微服务调用另外一个微服务时，服务提供者需要负载均衡算法提供一个节点进行响应。**负载均衡是分布式必须实施的方案。**作用：分摊服务的压力，即使响应。此外，可能出现某个节点故障的风险，通过负载均衡算法就可以将腹胀节点排除，使后续请求发散到其他可用节点上，体现了Spring Cloud的高可用。Spring Cloud 提供了Ribbon来实现这些功能。
* **声明服务调用：**对于REST风格的调用，如果是哟共RestTemplate会比较繁琐，可读性不高。为了简化多次调用的夫再度，Spring Cloud提供了接口式的声明服务调用编程 Feign。**请求其他微服务时，就如同调度本地服务的java接口一样。**
* **断路器：**在分布式中，因为存在网络延迟或者故障，一些服务掉员工无法及时响应。如果此时服务消费者还在大量调用这些网络延迟或者故障的服务提供者，很快消费者也会应为大量的等待，造成积压。最终导致其自身出现服务瘫痪。为了克服这个问题，Spring Cloud提供了NetFlix的开源框架Hystrix来处理这些问题。当服务消费者长期得不到提供者响应时，就可以进行**降级、服务断路、线程和信号隔离、请求缓存或者、合并处理**。
* **API网关：**Spring Cloud中API网关式Zuul。网关作用：
  * **将请求的地址映射为真实服务器的地址**，例如，用户请求http://localhost/user/1而真实的服务是http://localhost:8001/user/1和http://localhost:8002/user/1都可以。这是就可以通过网关使得localhost/user映射为对应真实服务器的地址。**作用就是路由分发，从而降低单个节点的负载。可以称为服务端负载均衡。从高可用的角度来说，则一个请求地址可以映射到堕胎服务上，如果单点出现故障，其他节点也能提供服务，这样就是一个高可用的服务了。**
  * **过滤服务**，互联网中，服务器可能面临各种攻击，Zuul提供了过滤器，通过它过滤那些恶意或者无效的请求，把它们排除在服务网站之外，降低网站服务风险。

其他分布式服务技术：分布式事务、分布式数据一致性、消息总线等。

Spring Cloud 微服务实例:

![image-20200824173349525](https://gitee.com/wuugui/cloudimage/raw/master/java/springboot/image-20200824173349525.png)

### 1. 服务治理和服务发现 -- Eureka

#### 1.1 配置服务治理节点

Eureka是构建Spring Cloud分布式最为核心和基础的模块。作用是注册和发现哥哥Spring Boot微服务，并提供监控和管理的功能。